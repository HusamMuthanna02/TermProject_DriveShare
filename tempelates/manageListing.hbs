<!DOCTYPE html>
<html>
<head>
    <title>Manage Your Listings</title>
</head>
<body>
    <h1>Manage Your Car Listings</h1>

    {{#if cars}}
        <ul>
            {{#each cars}}
                <li>
                    Model: {{model}}, Year: {{year}}, Mileage: {{mileage}}, Price: {{rentalPrice}}
                    <br>
                    Availability:
                    {{#if availability}}
                        {{#each availability}}
                            <!-- Debugging: Display the startDate, endDate, and isAvailable 
                            <p>Debug: startDate = {{startDate}}</p>
                            <p>Debug: endDate = {{endDate}}</p>
                            <p>Debug: isAvailable = {{isAvailable this}}</p>-->
                            {{#if (isAvailable this)}}
                                Available until {{dateFormat endDate 'MM-DD-YYYY'}}
                            {{else}}
                                Unavailable
                            {{/if}}
                            <br>
                        {{/each}}
                    {{else}}
                        Available Now
                    {{/if}}
                    <br>
                    {{#if bookings.length}}
                        <strong>Bookings:</strong>
                        <ul>
                            {{#each bookings}}
                                <li>
                                    Renter: {{renterUsername}}, From: {{dateFormat startDate 'MM-DD-YYYY'}} To: {{dateFormat endDate 'MM-DD-YYYY'}}
                                </li>
                            {{/each}}
                        </ul>
                    {{else}}
                        <p>No bookings for this car.</p>
                    {{/if}}
                    <a href="/car/edit/{{_id}}">Edit</a>
                </li>
            {{/each}}
        </ul>
    {{else}}
        <p>You have no car listings yet.</p>
    {{/if}}

    <a href="/car/list">Add a New Car</a>
    <br>
</body>
</html>